(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1204:function(e,t,n){"use strict";window.FileAPI={staticPath:"/static/FileApi/",cors:!0,withCredentials:!1}},1205:function(J,K,Q){"use strict";(function(p){var e,t,a,s,l,u,i,c,n,r,o,f,g,v,y,w,d,h,m,b,A,x,I,F,R,T,_,E,C,D,P,k,Z=Q(1)(Q(41));function U(){this.items=[]}function B(t,n,e){var a=t.blob,i=t.file;if(i){if(!a.toDataURL)return void c.readAsBinaryString(a,function(e){"load"==e.type&&n(t,e.result)});var r={"image/jpeg":".jpe?g","image/png":".png"},o=r[t.type]?t.type:"image/png",s=r[o]||".png",l=a.quality||1;i.match(new RegExp(s+"$","i"))||(i+=s.replace("?","")),t.file=i,t.type=o,!e&&a.toBlob?a.toBlob(function(e){n(t,e)},o,l):n(t,c.toBinaryString(a.toDataURL(o,l)))}else n(t,a)}function L(){}function S(e){this.uid=v.uid(),this.xhr={abort:L,getResponseHeader:L,getAllResponseHeaders:L},this.options=e}function z(n){return('<object id="#id#" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+(n.width||"100%")+'" height="'+(n.height||"100%")+'"><param name="movie" value="#src#" /><param name="flashvars" value="#flashvars#" /><param name="swliveconnect" value="true" /><param name="allowscriptaccess" value="always" /><param name="allownetworking" value="all" /><param name="menu" value="false" /><param name="wmode" value="#wmode#" /><embed flashvars="#flashvars#" swliveconnect="true" allownetworking="all" allowscriptaccess="always" name="#id#" src="#src#" width="'+(n.width||"100%")+'" height="'+(n.height||"100%")+'" menu="false" wmode="transparent" type="application/x-shockwave-flash"></embed></object>').replace(/#(\w+)#/gi,function(e,t){return n[t]})}function j(e,t){var n,a;if(e&&e.style)for(n in t){"number"==typeof(a=t[n])&&(a+="px");try{e.style[n]=a}catch(e){}}}function O(a,e){E(e,function(e,t){var n=a[t];a[t]=function(){return this.parent=n,e.apply(this,arguments)}})}function H(e){return e&&!e.flashId}function M(e){var t=e.wid=m.uid();return F._fn[t]=e,"FileAPI.Flash._fn."+t}function N(e){try{F._fn[e.wid]=null,delete F._fn[e.wid]}catch(e){}}function q(e,t){if(!I.test(e)){if(/^\.\//.test(e)||"/"!=e.charAt(0)){var n=T.pathname;e=((n=n.substr(0,n.lastIndexOf("/")))+"/"+e).replace("/./","/")}"//"!=e.substr(0,2)&&(e="//"+T.host+e),I.test(e)||(e=T.protocol+e)}return t&&(e+=(/\?/.test(e)?"&":"?")+t),e}function X(e,t,n){var a,i=m.uid(),r=R.createElement("div"),o=10;for(a in e)r.setAttribute(a,e[a]),r[a]=e[a];j(r,e),e.width="100%",e.height="100%",r.innerHTML=z(m.extend({id:i,src:q(m.flashImageUrl,"r="+m.uid()),wmode:"opaque",flashvars:"scale="+e.scale+"&callback="+M(function e(){return N(e),0<--o&&function(){try{F.get(i).setImage(t)}catch(e){m.log('[err] FlashAPI.Preview.setImage -- can not set "base64":',e)}}(),!0})},e)),n(!1,r),r=null}function W(e){var t=e.wid=C.uid();return C.Flash._fn[t]=e,"FileAPI.Flash._fn."+t}function G(e){try{C.Flash._fn[e.wid]=null,delete C.Flash._fn[e.wid]}catch(e){}}
/*! FileAPI 2.0.19 - BSD | git://github.com/mailru/FileAPI.git
 * FileAPI â€” a set of  javascript tools for working with files. Multiupload, drag'n'drop and chunked file upload. Images: crop, resize and auto orientation by EXIF.
 */
t=window,a=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,s=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),l=s&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),u=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,i=(s||u)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,n,a,i,r,o;for(t=(0<=e.split(",")[0].indexOf("base64")?atob:decodeURIComponent)(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),i=0;i<t.length;i+=1)a[i]=t.charCodeAt(i);return r=e.split(",")[0].split(":")[1].split(";")[0],s?new Blob([l?a:n],{type:r}):((o=new u).append(n),o.getBlob(r))},t.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(e,t,n){n&&a.toDataURL&&i?e(i(this.toDataURL(t,n))):e(this.mozGetAsFile("blob",t))}:a.toDataURL&&i&&(a.toBlob=function(e,t,n){e(i(this.toDataURL(t,n)))})),t.dataURLtoBlob=i,function(i,o){function m(){}function e(e){return(e=new i.Number(z.pow(1024,e))).from=function(e){return z.round(e*this)},e}function p(e){return e&&"length"in e}function g(e,t,n){if(e)if(p(e))for(var a=0,i=e.length;a<i;a++)a in e&&t.call(n,e[a],a,e);else for(var r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function s(t,e,n){if(t){var a=W.uid(t);j[a]||(j[a]={});var i=x&&t&&t instanceof x;g(e.split(/\s+/),function(e){R&&!i?R.event.add(t,e,n):(j[a][e]||(j[a][e]=[]),j[a][e].push(n),t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n)})}}function l(a,e,i){if(a){var t=W.uid(a),r=j[t]||{},o=x&&a&&a instanceof x;g(e.split(/\s+/),function(e){if(R&&!o)R.event.remove(a,e,i);else{for(var t=r[e]||[],n=t.length;n--;)if(t[n]===i){t.splice(n,1);break}a.addEventListener?a.removeEventListener(e,i,!1):a.detachEvent?a.detachEvent("on"+e,i):a["on"+e]=null}})}}function h(n,a,i){s(n,a,function e(t){l(n,a,e),i(t)})}function r(e){return e.target||(e.target=i.event&&i.event.srcElement||c),3===e.target.nodeType&&(e.target=e.target.parentNode),e}function t(e){var t=c.createElement("input");return t.setAttribute("type","file"),e in t}var n,a,u=1,c=i.document,f=c.doctype||{},d=i.navigator.userAgent,v=/safari\//i.test(d)&&!/chrome\//i.test(d),y=/iemobile\//i.test(d),w=i.createObjectURL&&i||i.URL&&URL.revokeObjectURL&&URL||i.webkitURL&&webkitURL,b=i.Blob,A=i.File,x=i.FileReader,I=i.FormData,F=i.XMLHttpRequest,R=i.jQuery,T=!(!(A&&x&&(i.Uint8Array||I||F.prototype.sendAsBinary))||v&&/windows/i.test(d)&&!y),_=T&&"withCredentials"in new F,E=T&&!!b&&!!(b.prototype.webkitSlice||b.prototype.mozSlice||b.prototype.slice),C=0<(""+"".normalize).indexOf("[native code]"),D=i.dataURLtoBlob,P=/img/i,k=/canvas/i,U=/img|canvas/i,B=/input/i,L=/^data:[^,]+,/,S={}.toString,z=i.Math,j={},O=[],H="abort progress error load loadend",M="status statusText readyState response responseXML responseText responseBody".split(" "),N="currentTarget",q="preventDefault",X=function(n){for(var e=arguments,t=1,a=function(e,t){n[t]=e};t<e.length;t++)g(e[t],a);return n},W={version:"2.0.19",cors:!1,html5:!0,media:!1,formData:!0,multiPassResize:!0,debug:!1,pingUrl:!1,multiFlash:!1,flashAbortTimeout:0,withCredentials:!0,staticPath:"./dist/",flashUrl:0,flashImageUrl:0,postNameConcat:function(e,t){return e+(null!=t?"["+t+"]":"")},ext2mime:{jpg:"image/jpeg",tif:"image/tiff",txt:"text/plain"},accept:{"image/*":"art bm bmp dwg dxf cbr cbz fif fpx gif ico iefs jfif jpe jpeg jpg jps jut mcf nap nif pbm pcx pgm pict pm png pnm qif qtif ras rast rf rp svf tga tif tiff xbm xbm xpm xwd","audio/*":"m4a flac aac rm mpa wav wma ogg mp3 mp2 m3u mod amf dmf dsm far gdm imf it m15 med okt s3m stm sfx ult uni xm sid ac3 dts cue aif aiff wpl ape mac mpc mpp shn wv nsf spc gym adplug adx dsp adp ymf ast afc hps xs","video/*":"m4v 3gp nsv ts ty strm rm rmvb m3u ifo mov qt divx xvid bivx vob nrg img iso pva wmv asf asx ogm m2v avi bin dat dvr-ms mpg mpeg mp4 mkv avc vp3 svq3 nuv viv dv fli flv wpl"},uploadRetry:0,networkDownRetryTimeout:5e3,chunkSize:0,chunkUploadRetry:0,chunkNetworkDownRetryTimeout:2e3,KB:e(1),MB:e(2),GB:e(3),TB:e(4),EMPTY_PNG:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NkAAIAAAoAAggA9GkAAAAASUVORK5CYII=",expando:"fileapi"+(new Date).getTime(),uid:function(e){return e?e[W.expando]=e[W.expando]||W.uid():(++u,W.expando+u)},log:function(){W.debug&&n&&(a?console.log.apply(console,arguments):console.log([].join.call(arguments," ")))},newImage:function(e,t){var n=c.createElement("img");return t&&W.event.one(n,"error load",function(e){t("error"==e.type,n),n=null}),n.src=e,n},getXHR:function(){var t;if(F)t=new F;else if(i.ActiveXObject)try{t=new ActiveXObject("MSXML2.XMLHttp.3.0")}catch(e){t=new ActiveXObject("Microsoft.XMLHTTP")}return t},isArray:p,support:{dnd:_&&"ondrop"in c.createElement("div"),cors:_,html5:T,chunked:E,dataURI:!0,accept:t("accept"),multiple:t("multiple")},event:{on:s,off:l,one:h,fix:r},throttle:function(e,t){var n,a;return function(){a=arguments,n||(e.apply(i,a),n=setTimeout(function(){n=0,e.apply(i,a)},t))}},F:function(){},parseJSON:function(e){return i.JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e.replace(/([\r\n])/g,"\\$1")+");")()},trim:function(e){return(e=String(e)).trim?e.trim():e.replace(/^\s+|\s+$/g,"")},defer:function(){var n,a,i=[],r={resolve:function(e,t){for(r.resolve=m,a=e||!1,n=t;t=i.shift();)t(a,n)},then:function(e){a!==o?e(a,n):i.push(e)}};return r},queue:function(e){var t=0,n=0,a=!1,i=!1,r={inc:function(){n++},next:function(){t++,setTimeout(r.check,0)},check:function(){n<=t&&!a&&r.end()},isFail:function(){return a},fail:function(){a||e(a=!0)},end:function(){i||(i=!0,e())}};return r},each:g,afor:function(t,n){var a=0,i=t.length;p(t)&&i--?function e(){n(i!=a&&e,t[a],a++)}():n(!1)},extend:X,isFile:function(e){return"[object File]"===S.call(e)},isBlob:function(e){return this.isFile(e)||"[object Blob]"===S.call(e)},isCanvas:function(e){return e&&k.test(e.nodeName)},getFilesFilter:function(e){return(e="string"==typeof e?e:e.getAttribute&&e.getAttribute("accept")||"")?new RegExp("("+e.replace(/\./g,"\\.").replace(/,/g,"|")+")$","i"):/./},readAsDataURL:function(e,t){W.isCanvas(e)?G(e,t,"load",W.toDataURL(e)):K(e,t,"DataURL")},readAsBinaryString:function(e,n){J("BinaryString")?K(e,n,"BinaryString"):K(e,function(t){if("load"==t.type)try{t.result=W.toBinaryString(t.result)}catch(e){t.type="error",t.message=e.toString()}n(t)},"DataURL")},readAsArrayBuffer:function(e,t){K(e,t,"ArrayBuffer")},readAsText:function(e,t,n){n||(n=t,t="utf-8"),K(e,n,"Text",t)},toDataURL:function(e,t){return"string"==typeof e?e:e.toDataURL?e.toDataURL(t||"image/png"):void 0},toBinaryString:function(e){return i.atob(W.toDataURL(e).replace(L,""))},readAsImage:function(n,a,t){if(W.isBlob(n))if(w){var e=w.createObjectURL(n);e===o?G(n,a,"error"):W.readAsImage(e,a,t)}else W.readAsDataURL(n,function(e){"load"==e.type?W.readAsImage(e.result,a,t):!t&&"error"!=e.type||G(n,a,e,null,{loaded:e.loaded,total:e.total})});else if(W.isCanvas(n))G(n,a,"load",n);else if(P.test(n.nodeName))if(n.complete)G(n,a,"load",n);else{var i="error abort load";h(n,i,function e(t){"load"==t.type&&w&&w.revokeObjectURL(n.src),l(n,i,e),G(n,a,t,n)})}else if(n.iframe)G(n,a,{type:"error"});else{var r=W.newImage(n.dataURL||n);W.readAsImage(r,a,t)}},checkFileObj:function(e){var n={},t=W.accept;return"object"==(0,Z.default)(e)?n=e:n.name=(e+"").split(/\\|\//g).pop(),null==n.type&&(n.type=n.name.split(".").pop()),g(t,function(e,t){((e=new RegExp(e.replace(/\s/g,"|"),"i")).test(n.type)||W.ext2mime[n.type])&&(n.type=W.ext2mime[n.type]||t.split("/")[0]+"/"+n.type)}),n},getDropFiles:function(e,t){var n,a=[],i=[],r=$(e),o=r.files,s=r.items,l=p(s)&&s[0]&&V(s[0]),u=W.queue(function(){t(a,i)});if(l)if(C&&o){var c,f,d=o.length;for(n=new Array(d);d--;){c=o[d];try{f=V(s[d])}catch(e){W.log("[err] getDropFiles: ",e),f=null}Q(f)&&(f.isDirectory||f.isFile&&c.name==c.name.normalize("NFC"))?n[d]=f:n[d]=c}}else n=s;else n=o;g(n||[],function(n){u.inc();try{l&&Q(n)?function t(n,a){if(n)if(n.isFile)n.file(function(e){e.fullPath=n.fullPath,a(!1,[e],[e])},function(e){n.error=e,a("FileError.code: "+e.code,[],[n])});else if(n.isDirectory){var r=n.createReader(),o=!0,s=[],l=[n],u=function(e){n.error=e,a("DirectoryError.code: "+e.code,s,l)},e=function i(e){o&&(o=!1,e.length||(n.error=new Error("directory is empty"))),e.length?W.afor(e,function(a,e){t(e,function(e,t,n){e||(s=s.concat(t)),l=l.concat(n),a?a():r.readEntries(i,u)})}):a(!1,s,l)};r.readEntries(e,u)}else t(V(n),a);else{var i=new Error("invalid entry");(n=new Object(n)).error=i,a(i.message,[],[n])}}(n,function(e,t,n){e?W.log("[err] getDropFiles:",e):a.push.apply(a,t),i.push.apply(i,n),u.next()}):function(e,n){if(!e.type&&(v||e.size%4096==0&&e.size<=102400))if(x)try{var a=new x;h(a,H,function(e){var t="error"!=e.type;t?(null!=a.readyState&&a.readyState!==a.LOADING||a.abort(),n(t)):n(!1,a.error)}),a.readAsDataURL(e)}catch(e){n(!1,e)}else n(null,new Error("FileReader is not supported"));else n(!0)}(n,function(e,t){e?a.push(n):n.error=t,i.push(n),u.next()})}catch(e){u.next(),W.log("[err] getDropFiles: ",e)}}),u.check()},getFiles:function(e,t,n){var a=[];return n?(W.filterFiles(W.getFiles(e),t,n),null):(e.jquery&&(e.each(function(){a=a.concat(W.getFiles(this))}),e=a,a=[]),"string"==typeof t&&(t=W.getFilesFilter(t)),e.originalEvent?e=r(e.originalEvent):e.srcElement&&(e=r(e)),e.dataTransfer?e=e.dataTransfer:e.target&&(e=e.target),e.files?(a=e.files,T||(a[0].blob=e,a[0].iframe=!0)):!T&&Y(e)?W.trim(e.value)&&((a=[W.checkFileObj(e.value)])[0].blob=e,a[0].iframe=!0):p(e)&&(a=e),W.filter(a,function(e){return!t||t.test(e.name)}))},getTotalSize:function(e){for(var t=0,n=e&&e.length;n--;)t+=e[n].size;return t},getInfo:function(t,a){var i={},r=O.concat();W.isBlob(t)?function n(){var e=r.shift();e?e.test(t.type)?e(t,function(e,t){e?a(e):(X(i,t),n())}):n():a(!1,i)}():a("not_support_info",i)},addInfoReader:function(t,e){e.test=function(e){return t.test(e)},O.push(e)},filter:function(e,t){for(var n,a=[],i=0,r=e.length;i<r;i++)i in e&&(n=e[i],t.call(n,n,i,e)&&a.push(n));return a},filterFiles:function(e,a,t){if(e.length){var i,r=e.concat(),o=[],s=[];!function n(){r.length?(i=r.shift(),W.getInfo(i,function(e,t){(a(i,!e&&t)?o:s).push(i),n()})):t(o,s)}()}else t([],e)},upload:function(s){(s=X({jsonp:"callback",prepare:W.F,beforeupload:W.F,upload:W.F,fileupload:W.F,fileprogress:W.F,filecomplete:W.F,progress:W.F,complete:W.F,pause:W.F,imageOriginal:!0,chunkSize:W.chunkSize,chunkUploadRetry:W.chunkUploadRetry,uploadRetry:W.uploadRetry},s)).imageAutoOrientation&&!s.imageTransform&&(s.imageTransform={rotate:"auto"});var l,u=new W.XHR(s),c=this._getFilesDataArray(s.files),f=this,d=0,p=0,h=!1;return g(c,function(e){d+=e.size}),u.files=[],g(c,function(e){u.files.push(e.file)}),u.total=d,u.loaded=0,u.filesLeft=c.length,s.beforeupload(u,s),l=function(){var n,a=c.shift(),i=a&&a.file,r=!1,o=(n={},g(s,function(e,t){e&&"object"===(0,Z.default)(e)&&void 0===e.nodeType&&(e=X({},e)),n[t]=e}),n);if(u.filesLeft=c.length,i&&i.name===W.expando&&(i=null,W.log("[warn] FileAPI.upload() â€” called without files")),("abort"!=u.statusText||u.current)&&a){if(h=!1,(u.currentFile=i)&&!1===s.prepare(i,o))return void l.call(f);o.file=i,f._getFormData(o,a,function(e){p||s.upload(u,s);var t=new W.XHR(X({},o,{upload:i?function(){s.fileupload(i,t,o)}:m,progress:i?function(e){r||(r=e.loaded===e.total,s.fileprogress({type:"progress",total:a.total=e.total,loaded:a.loaded=e.loaded},i,t,o),s.progress({type:"progress",total:d,loaded:u.loaded=p+a.size*(e.loaded/e.total)||0},i,t,o))}:m,complete:function(e){g(M,function(e){u[e]=t[e]}),i&&(a.total=a.total||a.size,a.loaded=a.total,e||(this.progress(a),r=!0,p+=a.size,u.loaded=p),s.filecomplete(e,t,i,o)),setTimeout(function(){l.call(f)},0)}}));u.abort=function(e){e||(c.length=0),this.current=e,t.abort()},t.send(e)})}else{var e=200==u.status||201==u.status||204==u.status;s.complete(!e&&(u.statusText||"error"),u,s),h=!0}},setTimeout(l,0),u.append=function(e,t){e=W._getFilesDataArray([].concat(e)),g(e,function(e){d+=e.size,u.files.push(e.file),t?c.unshift(e):c.push(e)}),u.statusText="",h&&l.call(f)},u.remove=function(e){for(var t,n=c.length;n--;)c[n].file==e&&(t=c.splice(n,1),d-=t.size);return t},u},_getFilesDataArray:function(e){var a=[],t={};if(Y(e)){var n=W.getFiles(e);t[e.name||"file"]=null!==e.getAttribute("multiple")?n:n[0]}else p(e)&&Y(e[0])?g(e,function(e){t[e.name||"file"]=W.getFiles(e)}):t=e;return g(t,function t(e,n){p(e)?g(e,function(e){t(e,n)}):e&&(e.name||e.image)&&a.push({name:n,file:e,size:e.size,total:e.size,loaded:0})}),a.length||a.push({file:{name:W.expando}}),a},_getFormData:function(i,e,t){var n=e.file,r=e.name,o=n.name,s=n.type,l=W.support.transform&&i.imageTransform,u=new W.Form,c=W.queue(function(){t(u)}),f=l&&function(e){var t;for(t in e)if(e.hasOwnProperty(t)&&!(e[t]instanceof Object||"overlay"===t||"filter"===t))return!0;return!1}(l),d=W.postNameConcat;g(i.data,function n(e,a){"object"==(0,Z.default)(e)?g(e,function(e,t){n(e,d(a,t))}):u.append(a,e)}),function n(a){a.image?(c.inc(),a.toData(function(e,t){a.file&&(t.type=a.file.type,t.quality=a.matrix.quality,o=a.file&&a.file.name),o=o||(new Date).getTime()+".png",n(t),c.next()})):W.Image&&l&&(/^image/.test(a.type)||U.test(a.nodeName))?(c.inc(),f&&(l=[l]),W.Image.transform(a,l,i.imageAutoOrientation,function(e,t){if(f&&!e)D||W.flashEngine||(u.multipart=!0),u.append(r,t[0],o,l[0].type||s);else{var n=0;e||g(t,function(e,t){D||W.flashEngine||(u.multipart=!0),l[t].postName||(n=1),u.append(l[t].postName||d(r,t),e,o,l[t].type||s)}),(e||i.imageOriginal)&&u.append(d(r,n?"original":null),a,o,s)}c.next()})):o!==W.expando&&u.append(r,a,o)}(n),c.check()},reset:function(n,e){var t,a;return R?(a=R(n).clone(!0).insertBefore(n).val("")[0],e||R(n).remove()):(t=n.parentNode,(a=t.insertBefore(n.cloneNode(!0),n)).value="",e||t.removeChild(n),g(j[W.uid(n)],function(e,t){g(e,function(e){l(n,t,e),s(a,t,e)})})),a},load:function(t,n){var a=W.getXHR();return a?(a.open("GET",t,!0),a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined"),s(a,"progress",function(e){e.lengthComputable&&n({type:e.type,loaded:e.loaded,total:e.total},a)}),a.onreadystatechange=function(){if(4==a.readyState)if(a.onreadystatechange=null,200==a.status){var e={name:(t=t.split("/"))[t.length-1],size:a.getResponseHeader("Content-Length"),type:a.getResponseHeader("Content-Type")};e.dataURL="data:"+e.type+";base64,"+W.encode64(a.responseBody||a.responseText),n({type:"load",result:e},a)}else n({type:"error"},a)},a.send(null)):n({type:"error"}),a},encode64:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",a=0;for("string"!=typeof e&&(e=String(e));a<e.length;){var i,r,o=255&e.charCodeAt(a++),s=255&e.charCodeAt(a++),l=255&e.charCodeAt(a++),u=o>>2,c=(3&o)<<4|s>>4;isNaN(s)?i=r=64:(i=(15&s)<<2|l>>6,r=isNaN(l)?64:63&l),n+=t.charAt(u)+t.charAt(c)+t.charAt(i)+t.charAt(r)}return n}};function G(e,t,n,a,i){var r={type:n.type||n,target:e,result:a};X(r,i),t(r)}function J(e){return x&&x.prototype["readAs"+e]}function K(a,i,e,t){if(W.isBlob(a)&&J(e)){var r=new x;s(r,H,function e(t){var n=t.type;"progress"==n?G(a,i,t,t.target.result,{loaded:t.loaded,total:t.total}):"loadend"==n?(l(r,H,e),r=null):G(a,i,t,t.target.result)});try{t?r["readAs"+e](a,t):r["readAs"+e](a)}catch(e){G(a,i,"error",o,{error:e.toString()})}}else G(a,i,"error",o,{error:"filreader_not_support_"+e})}function Q(e){return e&&(e.isFile||e.isDirectory)}function V(e){var t;return e.getAsEntry?t=e.getAsEntry():e.webkitGetAsEntry&&(t=e.webkitGetAsEntry()),t}function Y(e){return B.test(e&&e.tagName)}function $(e){return(e.originalEvent||e||"").dataTransfer||{}}W.addInfoReader(/^image/,function(e,t){if(!e.__dimensions){var n=e.__dimensions=W.defer();W.readAsImage(e,function(e){var t=e.target;n.resolve("load"!=e.type&&"error",{width:t.width,height:t.height}),t.src=W.EMPTY_PNG,t=null})}e.__dimensions.then(t)}),W.event.dnd=function(e,i,a){var r,o;a||(a=i,i=W.F),x?(s(e,"dragenter dragleave dragover",i.ff=i.ff||function(e){for(var t=$(e).types,n=t&&t.length,a=!1;n--;)if(~t[n].indexOf("File")){e[q](),o!==e.type&&("dragleave"!=(o=e.type)&&i.call(e[N],!0,e),a=!0);break}a&&(clearTimeout(r),r=setTimeout(function(){i.call(e[N],"dragleave"!=o,e)},50))}),s(e,"drop",a.ff=a.ff||function(n){n[q](),o=0,i.call(n[N],!1,n),W.getDropFiles(n,function(e,t){a.call(n[N],e,t,n)})})):W.log("Drag'n'Drop -- not supported")},W.event.dnd.off=function(e,t,n){l(e,"dragenter dragleave dragover",t.ff),l(e,"drop",n.ff)},R&&!R.fn.dnd&&(R.fn.dnd=function(e,t){return this.each(function(){W.event.dnd(this,e,t)})},R.fn.offdnd=function(e,t){return this.each(function(){W.event.dnd.off(this,e,t)})}),i.FileAPI=X(W,i.FileAPI),W.log("FileAPI: "+W.version),W.log("protocol: "+i.location.protocol),W.log("doctype: ["+f.name+"] "+f.publicId+" "+f.systemId),g(c.getElementsByTagName("meta"),function(e){/x-ua-compatible/i.test(e.getAttribute("http-equiv"))&&W.log("meta.http-equiv: "+e.getAttribute("content"))});try{n=!!console.log,a=!!console.log.apply}catch(e){}W.flashUrl||(W.flashUrl=W.staticPath+"FileAPI.flash.swf"),W.flashImageUrl||(W.flashImageUrl=W.staticPath+"FileAPI.flash.image.swf"),W.flashWebcamUrl||(W.flashWebcamUrl=W.staticPath+"FileAPI.flash.camera.swf")}(window,void 0),function(y,n){function w(){return n.createElement("canvas")}var b=Math.min,f=Math.round,e=!1,r={8:270,3:180,6:90,7:270,4:180,5:90};try{e=-1<w().toDataURL("image/png").indexOf("data:image/png")}catch(e){}function A(e){if(e instanceof A){var t=new A(e.file);return y.extend(t.matrix,e.matrix),t}if(!(this instanceof A))return new A(e);this.file=e,this.size=e.size||100,this.matrix={sx:0,sy:0,sw:0,sh:0,dx:0,dy:0,dw:0,dh:0,resize:0,deg:0,quality:1,filter:0}}A.prototype={image:!0,constructor:A,set:function(e){return y.extend(this.matrix,e),this},crop:function(e,t,n,a){return void 0===n&&(n=e,a=t,e=t=0),this.set({sx:e,sy:t,sw:n,sh:a||n})},resize:function(e,t,n){return/min|max|height|width/.test(t)&&(n=t,t=e),this.set({dw:e,dh:t||e,resize:n})},preview:function(e,t){return this.resize(e,t||e,"preview")},rotate:function(e){return this.set({deg:e})},filter:function(e){return this.set({filter:e})},overlay:function(e){return this.set({overlay:e})},clone:function(){return new A(this)},_load:function(e,t){var n=this;/img|video/i.test(e.nodeName)?t.call(n,null,e):y.readAsImage(e,function(e){t.call(n,"load"!=e.type,e.result)})},_apply:function(e,t){var n,a=w(),i=this.getMatrix(e),l=a.getContext("2d"),r=e.videoWidth||e.width,o=e.videoHeight||e.height,s=i.deg,u=i.dw,c=i.dh,f=r,d=o,p=i.filter,h=e,m=i.overlay,g=y.queue(function(){e.src=y.EMPTY_PNG,t(!1,a)}),v=y.renderImageToCanvas;for(s-=360*Math.floor(s/360),e._type=this.file.type;i.multipass&&2<b(f/u,d/c);)f=f/2+.5|0,d=d/2+.5|0,(n=w()).width=f,n.height=d,h!==e?(v(n,h,0,0,h.width,h.height,0,0,f,d),h=n):(v(h=n,e,i.sx,i.sy,i.sw,i.sh,0,0,f,d),i.sx=i.sy=i.sw=i.sh=0);a.width=s%180?c:u,a.height=s%180?u:c,a.type=i.type,a.quality=i.quality,l.rotate(s*Math.PI/180),v(l.canvas,h,i.sx,i.sy,i.sw||h.width,i.sh||h.height,180==s||270==s?-u:0,90==s||180==s?-c:0,u,c),u=a.width,c=a.height,m&&y.each([].concat(m),function(r){g.inc();function o(){var e=0|r.x,t=0|r.y,n=r.w||s.width,a=r.h||s.height,i=r.rel;e=1==i||4==i||7==i?(u-n+e)/2:2==i||5==i||8==i?u-(n+e):e,t=3==i||4==i||5==i?(c-a+t)/2:6<=i?c-(a+t):t,y.event.off(s,"error load abort",o);try{l.globalAlpha=r.opacity||1,l.drawImage(s,e,t,n,a)}catch(e){}g.next()}var s=new window.Image;y.event.on(s,"error load abort",o),s.src=r.src,s.complete&&o()}),p&&(g.inc(),A.applyFilter(a,p,g.next)),g.check()},getMatrix:function(e){var t,n,a=y.extend({},this.matrix),i=a.sw=a.sw||e.videoWidth||e.naturalWidth||e.width,r=a.sh=a.sh||e.videoHeight||e.naturalHeight||e.height,o=a.dw=a.dw||i,s=a.dh=a.dh||r,l=i/r,u=o/s,c=a.resize;"preview"==c?o==i&&s==r||(l<=u?n=(t=i)/u:t=(n=r)*u,t==i&&n==r||(a.sx=~~((i-t)/2),a.sy=~~((r-n)/2),i=t,r=n)):"height"==c?o=s*l:"width"==c?s=o/l:c&&(s=o<i||s<r?"min"==c?(o=f(l<u?b(i,o):s*l),f(l<u?o/l:b(r,s))):(o=f(u<=l?b(i,o):s*l),f(u<=l?o/l:b(r,s))):(o=i,r));return a.sw=i,a.sh=r,a.dw=o,a.dh=s,a.multipass=y.multiPassResize,a},_trans:function(n){this._load(this.file,function(e,t){if(e)n(e);else try{this._apply(t,n)}catch(e){y.log("[err] FileAPI.Image.fn._apply:",e),n(e)}})},get:function(n){if(y.support.transform){var a=this,i=a.matrix;"auto"==i.deg?y.getInfo(a.file,function(e,t){i.deg=r[t&&t.exif&&t.exif.Orientation]||0,a._trans(n)}):a._trans(n)}else n("not_support_transform");return this},toData:function(e){return this.get(e)}},A.exifOrientation=r,A.transform=function(l,t,u,n){function e(e,r){var o={},s=y.queue(function(e){n(e,o)});e?s.fail():y.each(t,function(e,n){if(!s.isFail()){var t=new A(r.nodeType?r:l),a="function"==typeof e;if(a?e(r,t):e.width?t[e.preview?"preview":"resize"](e.width,e.height,e.strategy):e.maxWidth&&(r.width>e.maxWidth||r.height>e.maxHeight)&&t.resize(e.maxWidth,e.maxHeight,"max"),e.crop){var i=e.crop;t.crop(0|i.x,0|i.y,i.w||i.width,i.h||i.height)}void 0===e.rotate&&u&&(e.rotate="auto"),t.set({type:t.matrix.type||e.type||l.type||"image/png"}),a||t.set({deg:e.rotate,overlay:e.overlay,filter:e.filter,quality:e.quality||1}),s.inc(),t.toData(function(e,t){e?s.fail():(o[n]=t,s.next())})}})}l.width?e(!1,l):y.getInfo(l,e)},y.each(["TOP","CENTER","BOTTOM"],function(n,a){y.each(["LEFT","CENTER","RIGHT"],function(e,t){A[n+"_"+e]=3*a+t,A[e+"_"+n]=3*a+t})}),A.toCanvas=function(e){var t=n.createElement("canvas");return t.width=e.videoWidth||e.width,t.height=e.videoHeight||e.height,t.getContext("2d").drawImage(e,0,0),t},A.fromDataURL=function(e,t,n){var a=y.newImage(e);y.extend(a,t),n(a)},A.applyFilter=function(e,t,n){"function"==typeof t?t(e,n):window.Caman&&window.Caman("IMG"==e.tagName?A.toCanvas(e):e,function(){"string"==typeof t?this[t]():y.each(t,function(e,t){this[t](e)},this),this.render(n)})},y.renderImageToCanvas=function(e,t,n,a,i,r,o,s,l,u){try{return e.getContext("2d").drawImage(t,n,a,i,r,o,s,l,u)}catch(e){throw y.log("renderImageToCanvas failed"),e}},y.support.canvas=y.support.transform=e,y.Image=A}(FileAPI,document),function(y){"use strict";if(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform)){return}var w=y.renderImageToCanvas;y.detectSubsampling=function(e){var t,n;if(e.width*e.height>1024*1024){t=document.createElement("canvas");t.width=t.height=1;n=t.getContext("2d");n.drawImage(e,-e.width+1,0);return n.getImageData(0,0,1,1).data[3]===0}return false},y.detectVerticalSquash=function(e,t){var n=e.naturalHeight||e.height,a=document.createElement("canvas"),i=a.getContext("2d"),r,o,s,l,u;if(t){n/=2}a.width=1;a.height=n;i.drawImage(e,0,0);r=i.getImageData(0,0,1,n).data;o=0;s=n;l=n;while(l>o){u=r[(l-1)*4+3];if(u===0){s=l}else{o=l}l=s+o>>1}return l/n||1},y.renderImageToCanvas=function(e,t,n,a,i,r,o,s,l,u){if(t._type==="image/jpeg"){var c=e.getContext("2d"),f=document.createElement("canvas"),d=1024,p=f.getContext("2d"),h,m,g,v;f.width=d;f.height=d;c.save();h=y.detectSubsampling(t);if(h){n/=2;a/=2;i/=2;r/=2}m=y.detectVerticalSquash(t,h);if(h||m!==1){a*=m;l=Math.ceil(d*l/i);u=Math.ceil(d*u/r/m);s=0;v=0;while(v<r){o=0;g=0;while(g<i){p.clearRect(0,0,d,d);p.drawImage(t,n,a,i,r,-g,-v,i,r);c.drawImage(f,0,0,d,d,o,s,l,u);g+=d;o+=l}v+=d;s+=u}c.restore();return e}}return w(e,t,n,a,i,r,o,s,l,u)}}(FileAPI),c=FileAPI,n=window,r=n.document,o=n.FormData,f=n.encodeURIComponent,U.prototype={append:function(e,t,n,a){this.items.push({name:e,blob:t&&t.blob||(null==t?"":t),file:t&&(n||t.name),type:t&&(a||t.type)})},each:function(e){for(var t=0,n=this.items.length;t<n;t++)e.call(this,this.items[t])},toData:function(e,t){t._chunked=c.support.chunked&&0<t.chunkSize&&1==c.filter(this.items,function(e){return e.file}).length,c.support.html5?c.formData&&!this.multipart&&o?t._chunked?(c.log("FileAPI.Form.toPlainData"),this.toPlainData(e)):(c.log("FileAPI.Form.toFormData"),this.toFormData(e)):(c.log("FileAPI.Form.toMultipartData"),this.toMultipartData(e)):(c.log("FileAPI.Form.toHtmlData"),this.toHtmlData(e))},_to:function(t,n,a,i){var r=c.queue(function(){n(t)});this.each(function(e){try{a(e,t,r,i)}catch(e){c.log("FileAPI.Form._to: "+e.message),n(e)}}),r.check()},toHtmlData:function(e){this._to(r.createDocumentFragment(),e,function(e,t){var n,a=e.blob;e.file?(c.reset(a,!0),a.name=e.name,a.disabled=!1,t.appendChild(a)):((n=r.createElement("input")).name=e.name,n.type="hidden",n.value=a,t.appendChild(n))})},toPlainData:function(e){this._to({},e,function(e,n,a){e.file&&(n.type=e.file),e.blob.toBlob?(a.inc(),B(e,function(e,t){n.name=e.name,n.file=t,n.size=t.length,n.type=e.type,a.next()})):e.file?(n.name=e.blob.name,n.file=e.blob,n.size=e.blob.size,n.type=e.type):(n.params||(n.params=[]),n.params.push(f(e.name)+"="+f(e.blob))),n.start=-1,n.end=n.file&&n.file.FileAPIReadPosition||-1,n.retry=0})},toFormData:function(e){this._to(new o,e,function(e,n,a){e.blob&&e.blob.toBlob?(a.inc(),B(e,function(e,t){n.append(e.name,t,e.file),a.next()})):e.file?n.append(e.name,e.blob,e.file):n.append(e.name,e.blob),e.file&&n.append("_"+e.name,e.file)})},toMultipartData:function(e){this._to([],e,function(e,n,a,i){a.inc(),B(e,function(e,t){n.push("--_"+i+'\r\nContent-Disposition: form-data; name="'+e.name+'"'+(e.file?'; filename="'+f(e.file)+'"':"")+(e.file?"\r\nContent-Type: "+(e.type||"application/octet-stream"):"")+"\r\n\r\n"+(e.file?t:f(t))+"\r\n"),a.next()},!0)},c.expando)}},c.Form=U,g=window,v=FileAPI,y=g.document,w={"":1,XML:1,Text:1,Body:1},S.prototype={status:0,statusText:"",constructor:S,getResponseHeader:function(e){return this.xhr.getResponseHeader(e)},getAllResponseHeaders:function(){return this.xhr.getAllResponseHeaders()||{}},end:function(e,t){var n=this,a=n.options;n.end=n.abort=L,n.status=e,t&&(n.statusText=t),v.log("xhr.end:",e,t),a.complete(200!=e&&201!=e&&(n.statusText||"unknown"),n),n.xhr&&n.xhr.node&&setTimeout(function(){var e=n.xhr.node;try{e.parentNode.removeChild(e)}catch(e){}try{delete g[n.uid]}catch(e){}g[n.uid]=n.xhr.node=null},9)},abort:function(){this.end(0,"abort"),this.xhr&&(this.xhr.aborted=!0,this.xhr.abort())},send:function(e){var t=this,n=this.options;e.toData(function(e){e instanceof Error?t.end(0,e.message):(n.upload(n,t),t._send.call(t,n,e))},n)},_send:function(a,i){var r,o=this,s=o.uid,l=o.uid+"Load",n=a.url;if(v.log("XHR._send:",i),a.cache||(n+=(~n.indexOf("?")?"&":"?")+v.uid()),i.nodeName){var e=a.jsonp;n=n.replace(/([a-z]+)=(\?)/i,"$1="+s),a.upload(a,o);var u=function(e){if(~n.indexOf(e.origin))try{var t=v.parseJSON(e.data);t.id==s&&c(t.status,t.statusText,t.response)}catch(e){c(0,e.message)}},c=g[s]=function(e,t,n){o.readyState=4,o.responseText=n,o.end(e,t),v.event.off(g,"message",u),g[s]=r=f=g[l]=null};o.xhr.abort=function(){try{f.stop?f.stop():f.contentWindow.stop?f.contentWindow.stop():f.contentWindow.document.execCommand("Stop")}catch(e){}c(0,"abort")},v.event.on(g,"message",u),g[l]=function(){try{var e=f.contentWindow,t=e.document,n=e.result||v.parseJSON(t.body.innerHTML);c(n.status,n.statusText,n.response)}catch(e){v.log("[transport.onload]",e)}},(r=y.createElement("div")).innerHTML='<form target="'+s+'" action="'+n+'" method="POST" enctype="multipart/form-data" style="position: absolute; top: -1000px; overflow: hidden; width: 1px; height: 1px;"><iframe name="'+s+'" src="javascript:false;" onload="window.'+l+" && "+l+'();"></iframe>'+(e&&a.url.indexOf("=?")<0?'<input value="'+s+'" name="'+e+'" type="hidden"/>':"")+"</form>";var t=r.getElementsByTagName("form")[0],f=r.getElementsByTagName("iframe")[0];t.appendChild(i),v.log(t.parentNode.innerHTML),y.body.appendChild(r),o.xhr.node=r,o.readyState=2;try{t.submit()}catch(e){v.log("iframe.error: "+e)}t=null}else{if(n=n.replace(/([a-z]+)=(\?)&?/i,""),this.xhr&&this.xhr.aborted)return void v.log("Error: already aborted");if(r=o.xhr=v.getXHR(),i.params&&(n+=(n.indexOf("?")<0?"?":"&")+i.params.join("&")),r.open("POST",n,!0),v.withCredentials&&(r.withCredentials="true"),a.headers&&a.headers["X-Requested-With"]||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),v.each(a.headers,function(e,t){r.setRequestHeader(t,e)}),a._chunked){r.upload&&r.upload.addEventListener("progress",v.throttle(function(e){i.retry||a.progress({type:e.type,total:i.size,loaded:i.start+e.loaded,totalSize:i.size},o,a)},100),!1),r.onreadystatechange=function(){var e=parseInt(r.getResponseHeader("X-Last-Known-Byte"),10);if(o.status=r.status,o.statusText=r.statusText,o.readyState=r.readyState,4==r.readyState){for(var t in w)o["response"+t]=r["response"+t];if(r.onreadystatechange=null,!r.status||0<r.status-201)if(v.log("Error: "+r.status),(!r.status&&!r.aborted||500==r.status||416==r.status)&&++i.retry<=a.chunkUploadRetry){var n=r.status?0:v.chunkNetworkDownRetryTimeout;a.pause(i.file,a),v.log("X-Last-Known-Byte: "+e),e?i.end=e:(i.end=i.start-1,416==r.status&&(i.end=i.end-a.chunkSize)),setTimeout(function(){o._send(a,i)},n)}else o.end(r.status);else i.retry=0,i.end==i.size-1?o.end(r.status):(v.log("X-Last-Known-Byte: "+e),e&&(i.end=e),i.file.FileAPIReadPosition=i.end,setTimeout(function(){o._send(a,i)},0));r=null}},i.start=i.end+1,i.end=Math.max(Math.min(i.start+a.chunkSize,i.size)-1,i.start);var d=i.file,p=(d.slice||d.mozSlice||d.webkitSlice).call(d,i.start,i.end+1);i.size&&!p.size?setTimeout(function(){o.end(-1)}):(r.setRequestHeader("Content-Range","bytes "+i.start+"-"+i.end+"/"+i.size),r.setRequestHeader("Content-Disposition","attachment; filename="+encodeURIComponent(i.name)),r.setRequestHeader("Content-Type",i.type||"application/octet-stream"),r.send(p)),d=p=null}else if(r.upload&&r.upload.addEventListener("progress",v.throttle(function(e){a.progress(e,o,a)},100),!1),r.onreadystatechange=function(){if(o.status=r.status,o.statusText=r.statusText,o.readyState=r.readyState,4==r.readyState){for(var e in w)o["response"+e]=r["response"+e];if(r.onreadystatechange=null,!r.status||201<r.status)if(v.log("Error: "+r.status),(!r.status&&!r.aborted||500==r.status)&&(a.retry||0)<a.uploadRetry){a.retry=(a.retry||0)+1;var t=v.networkDownRetryTimeout;a.pause(a.file,a),setTimeout(function(){o._send(a,i)},t)}else o.end(r.status);else o.end(r.status);r=null}},v.isArray(i)){r.setRequestHeader("Content-Type","multipart/form-data; boundary=_"+v.expando);var h=i.join("")+"--_"+v.expando+"--";if(r.sendAsBinary)r.sendAsBinary(h);else{var m=Array.prototype.map.call(h,function(e){return 255&e.charCodeAt(0)});r.send(new Uint8Array(m).buffer)}}else r.send(i)}}},v.XHR=S,function(r,s){var l=r.URL||r.webkitURL,u=r.document,e=r.navigator,c=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia,o=!!c;s.support.media=o;function f(e){this.video=e}f.prototype={isActive:function(){return!!this._active},start:function(t){function n(e){r._active=!e,clearTimeout(i),clearTimeout(a),t&&t(e,r)}var a,i,r=this,o=r.video;c.call(e,{video:!0},function(e){r.stream=e,o.src=l.createObjectURL(e),a=setInterval(function(){!function(e){var t,n=u.createElement("canvas"),a=!1;try{(t=n.getContext("2d")).drawImage(e,0,0,1,1),a=255!=t.getImageData(0,0,1,1).data[4]}catch(e){s.log("[FileAPI.Camera] detectVideoSignal:",e)}return a}(o)||n(null)},1e3),i=setTimeout(function(){n("timeout")},5e3),o.play()},n)},stop:function(){try{this._active=!1,this.video.pause();try{this.stream.stop()}catch(e){s.each(this.stream.getTracks(),function(e){e.stop()})}this.stream=null}catch(e){s.log("[FileAPI.Camera] stop:",e)}},shot:function(){return new t(this.video)}},f.get=function(e){return new f(e.firstChild)},f.publish=function(n,a,i){"function"==typeof a&&(i=a,a={}),a=s.extend({},{width:"100%",height:"100%",start:!0},a),n.jquery&&(n=n[0]);function e(e){if(e)i(e);else{var t=f.get(n);a.start?t.start(i):i(null,t)}}if(n.style.width=d(a.width),n.style.height=d(a.height),s.html5&&o){var t=u.createElement("video");t.style.width=d(a.width),t.style.height=d(a.height),r.jQuery?p(n).empty():n.innerHTML="",n.appendChild(t),e()}else f.fallback(n,a,e)},f.fallback=function(e,t,n){n("not_support_camera")};var t=function(e){var t=e.nodeName?s.Image.toCanvas(e):e,n=s.Image(t);return n.type="image/png",n.width=t.width,n.height=t.height,n.size=t.width*t.height*4,n};function d(e){return 0<=e?e+"px":e}f.Shot=t,s.Camera=f}(window,FileAPI),d=window,h=window.jQuery,m=FileAPI,R=d.document,T=d.location,_=d.navigator,E=m.each,m.support.flash=function(){var e=_.mimeTypes,t=!1;if(_.plugins&&"object"==(0,Z.default)(_.plugins["Shockwave Flash"]))t=_.plugins["Shockwave Flash"].description&&!(e&&e["application/x-shockwave-flash"]&&!e["application/x-shockwave-flash"].enabledPlugin);else try{t=!(!d.ActiveXObject||!new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(e){m.log("Flash -- does not supported.")}return t&&/^file:/i.test(T)&&m.log("[warn] Flash does not work on `file:` protocol."),t}(),m.support.flash&&(!m.html5||!m.support.html5||m.cors&&!m.support.cors||m.media&&!m.support.media)&&(b=m.uid(),A=0,x={},I=/^https?:/i,F={_fn:{},init:function(){var e=R.body&&R.body.firstChild;if(e)do{if(1==e.nodeType){m.log("FlashAPI.state: awaiting");var t=R.createElement("div");return t.id="_"+b,j(t,{top:1,right:1,width:5,height:5,position:"absolute",zIndex:"2147483647"}),e.parentNode.insertBefore(t,e),void F.publish(t,b)}}while(e=e.nextSibling);A<10&&setTimeout(F.init,50*++A)},publish:function(e,t,n){n=n||{},e.innerHTML=z({id:t,src:q(m.flashUrl,"r="+m.version),wmode:n.camera?"":"transparent",flashvars:"callback="+(n.onEvent||"FileAPI.Flash.onEvent")+"&flashId="+t+"&storeKey="+_.userAgent.match(/\d/gi).join("")+"_"+m.version+(F.isReady||(m.pingUrl?"&ping="+m.pingUrl:""))+"&timeout="+m.flashAbortTimeout+(n.camera?"&useCamera="+q(m.flashWebcamUrl):"")+"&debug="+(m.debug?"1":"")})},ready:function(){m.log("FlashAPI.state: ready"),F.ready=m.F,F.isReady=!0,F.patch(),F.patchCamera&&F.patchCamera(),m.event.on(R,"mouseover",F.mouseover),m.event.on(R,"click",function(e){F.mouseover(e)&&(e.preventDefault?e.preventDefault():e.returnValue=!0)})},getEl:function(){return R.getElementById("_"+b)},getWrapper:function(e){do{if(/js-fileapi-wrapper/.test(e.className))return e}while((e=e.parentNode)&&e!==R.body)},mouseover:function(e){var t,n,a,i,r=m.event.fix(e).target;if(/input/i.test(r.nodeName)&&"file"==r.type&&!r.disabled){var o=r.getAttribute(b),s=F.getWrapper(r);if(m.multiFlash){if("i"==o||"r"==o)return!1;if("p"!=o){r.setAttribute(b,"i");var l=R.createElement("div");if(!s)return void m.log("[err] FlashAPI.mouseover: js-fileapi-wrapper not found");j(l,{top:0,left:0,width:r.offsetWidth,height:r.offsetHeight,zIndex:"2147483647",position:"absolute"}),s.appendChild(l),F.publish(l,m.uid()),r.setAttribute(b,"p")}return!0}if(s){var u=(n=(t=s).getBoundingClientRect(),a=R.body,i=(t&&t.ownerDocument).documentElement,{top:n.top+(d.pageYOffset||i.scrollTop)-(i.clientTop||a.clientTop||0),left:n.left+(d.pageXOffset||i.scrollLeft)-(i.clientLeft||a.clientLeft||0),width:n.right-n.left,height:n.bottom-n.top});j(F.getEl(),u),F.curInp=r}}else/object|embed/i.test(r.nodeName)||j(F.getEl(),{top:1,left:1,width:5,height:5})},onEvent:function(e){var t=e.type;if("ready"==t){try{F.getInput(e.flashId).setAttribute(b,"r")}catch(e){}return F.ready(),setTimeout(function(){F.mouseenter(e)},50),!0}"ping"===t?m.log("(flash -> js).ping:",[e.status,e.savedStatus],e.error):"log"===t?m.log("(flash -> js).log:",e.target):t in F&&setTimeout(function(){m.log("FlashAPI.event."+e.type+":",e),F[t](e)},1)},mouseenter:function(e){var t=F.getInput(e.flashId);if(t){F.cmd(e,"multiple",null!=t.getAttribute("multiple"));var n=[],a={};E((t.getAttribute("accept")||"").split(/,\s*/),function(e){m.accept[e]&&E(m.accept[e].split(" "),function(e){a[e]=1})}),E(a,function(e,t){n.push(t)}),F.cmd(e,"accept",n.length?n.join(",")+","+n.join(",").toUpperCase():"*")}},get:function(e){return R[e]||d[e]||R.embeds[e]},getInput:function(t){if(!m.multiFlash)return F.curInp;try{var e=F.getWrapper(F.get(t));if(e)return e.getElementsByTagName("input")[0]}catch(e){m.log('[err] Can not find "input" by flashId:',t,e)}},select:function(e){var t,n=F.getInput(e.flashId),a=m.uid(n),i=e.target.files;E(i,function(e){m.checkFileObj(e)}),x[a]=i,R.createEvent?((t=R.createEvent("Event")).files=i,t.initEvent("change",!0,!0),n.dispatchEvent(t)):h?h(n).trigger({type:"change",files:i}):((t=R.createEventObject()).files=i,n.fireEvent("onchange",t))},cmd:function(t,n,a,i){try{return m.log("(js -> flash)."+n+":",a),F.get(t.flashId||t).cmd(n,a)}catch(e){m.log("(js -> flash).onError:",e.toString()),i||setTimeout(function(){F.cmd(t,n,a,!0)},50)}},patch:function(){m.flashEngine=!0,O(m,{getFiles:function(e,t,n){if(n)return m.filterFiles(m.getFiles(e),t,n),null;var a=m.isArray(e)?e:x[m.uid(e.target||e.srcElement||e)];return a?(t&&(t=m.getFilesFilter(t),a=m.filter(a,function(e){return t.test(e.name)})),a):this.parent.apply(this,arguments)},getInfo:function(a,e){if(H(a))this.parent.apply(this,arguments);else if(a.isShot)e(null,a.info={width:a.width,height:a.height});else{if(!a.__info){var i=a.__info=m.defer();F.cmd(a,"getFileInfo",{id:a.id,callback:M(function e(t,n){N(e),i.resolve(t,a.info=n)})})}a.__info.then(e)}}}),m.support.transform=!0,m.Image&&O(m.Image.prototype,{get:function(e,t){return this.set({scaleMode:t||"noScale"}),this.parent(e)},_load:function(t,n){if(m.log("FlashAPI.Image._load:",t),H(t))this.parent.apply(this,arguments);else{var a=this;m.getInfo(t,function(e){n.call(a,e,t)})}},_apply:function(a,i){if(m.log("FlashAPI.Image._apply:",a),H(a))this.parent.apply(this,arguments);else{var r=this.getMatrix(a.info),o=i;F.cmd(a,"imageTransform",{id:a.id,matrix:r,callback:M(function e(t,n){m.log("FlashAPI.Image._apply.callback:",t),N(e),t?o(t):m.support.html5||m.support.dataURI&&!(3e4<n.length)?(r.filter&&(o=function(e,t){e?i(e):m.Image.applyFilter(t,r.filter,function(){i(e,this.canvas)})}),m.newImage("data:"+a.type+";base64,"+n,o)):X({width:r.deg%180?r.dh:r.dw,height:r.deg%180?r.dw:r.dh,scale:r.scaleMode},n,o)})})}},toData:function(e){var t=this.file,n=t.info,a=this.getMatrix(n);m.log("FlashAPI.Image.toData"),H(t)?this.parent.apply(this,arguments):("auto"==a.deg&&(a.deg=m.Image.exifOrientation[n&&n.exif&&n.exif.Orientation]||0),e.call(this,!t.info,{id:t.id,flashId:t.flashId,name:t.name,type:t.type,matrix:a}))}}),m.Image&&O(m.Image,{fromDataURL:function(e,t,n){!m.support.dataURI||3e4<e.length?X(m.extend({scale:"exactFit"},t),e.replace(/^data:[^,]+,/,""),function(e,t){n(t)}):this.parent(e,t,n)}}),O(m.Form.prototype,{toData:function(e){for(var t=this.items,n=t.length;n--;)if(t[n].file&&H(t[n].blob))return this.parent.apply(this,arguments);m.log("FlashAPI.Form.toData"),e(t)}}),O(m.XHR.prototype,{_send:function(i,e){if(e.nodeName||e.append&&m.support.html5||m.isArray(e)&&"string"==typeof e[0])return this.parent.apply(this,arguments);var n,a,r={},o={},s=this;if(E(e,function(e){var t;e.file?(o[e.name]=e={id:(t=e.blob).id,name:t.name,matrix:t.matrix,flashId:t.flashId},a=e.id,n=e.flashId):r[e.name]=e.blob}),a||(n=b),!n)return m.log("[err] FlashAPI._send: flashId -- undefined"),this.parent.apply(this,arguments);m.log("FlashAPI.XHR._send: "+n+" -> "+a),s.xhr={headers:{},abort:function(){F.cmd(n,"abort",{id:a})},getResponseHeader:function(e){return this.headers[e]},getAllResponseHeaders:function(){return this.headers}};var t=m.queue(function(){F.cmd(n,"upload",{url:q(i.url.replace(/([a-z]+)=(\?)&?/i,"")),data:r,files:a?o:null,headers:i.headers||{},callback:M(function e(t){var n=t.type,a=t.result;m.log("FlashAPI.upload."+n),"progress"==n?(t.loaded=Math.min(t.loaded,t.total),t.lengthComputable=!0,i.progress(t)):"complete"==n?(N(e),"string"==typeof a&&(s.responseText=a.replace(/%22/g,'"').replace(/%5c/g,"\\").replace(/%26/g,"&").replace(/%25/g,"%")),s.end(t.status||200)):"abort"!=n&&"error"!=n||(s.end(t.status||0,t.message),N(e))})})});E(o,function(e){t.inc(),m.getInfo(e,t.next)}),t.check()}})}},m.Flash=F,m.newImage("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",function(e,t){m.support.dataURI=!(1!=t.width||1!=t.height),F.init()})),window,window.jQuery,C=FileAPI,P=C.each,k=[],!C.support.flash||!C.media||C.support.media&&C.html5||(D=C.Flash,C.extend(C.Flash,{patchCamera:function(){C.Camera.fallback=function(e,t,n){var a=C.uid();C.log("FlashAPI.Camera.publish: "+a),D.publish(e,a,C.extend(t,{camera:!0,onEvent:W(function e(t){"camera"===t.type&&(G(e),t.error?(C.log("FlashAPI.Camera.publish.error: "+t.error),n(t.error)):(C.log("FlashAPI.Camera.publish.success: "+a),n(null)))})}))},P(k,function(e){C.Camera.fallback.apply(C.Camera,e)}),k=[],C.extend(C.Camera.prototype,{_id:function(){return this.video.id},start:function(n){var a=this;D.cmd(this._id(),"camera.on",{callback:W(function e(t){G(e),t.error?(C.log("FlashAPI.camera.on.error: "+t.error),n(t.error,a)):(C.log("FlashAPI.camera.on.success: "+a._id()),a._active=!0,n(null,a))})})},stop:function(){this._active=!1,D.cmd(this._id(),"camera.off")},shot:function(){C.log("FlashAPI.Camera.shot:",this._id());var e=C.Flash.cmd(this._id(),"shot",{});return e.type="image/png",e.flashId=this._id(),e.isShot=!0,new C.Camera.Shot(e)}})}}),C.Camera.fallback=function(){k.push(arguments)}),void 0===(e=function(){return FileAPI}.apply(K,[]))||(J.exports=e)}).call(this,Q(18))}}]);